!function(e){e.fn.tipuesearch=function(t){var i=e.extend({show:7,newWindow:!0,showURL:!0,showTitleCount:!0,minimumLength:5,descriptiveWords:25,highlightTerms:!0,highlightEveryTerm:!1,mode:"static",liveDescription:!0,liveContent:!0,contentLocation:"",debug:!1},t);return this.each(function(){function c(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function h(s,c){e("#tipue_search_content").hide(),e("#tipue_search_content").html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>'),e("#tipue_search_content").show();var n="",o=!1,u=!1,p=!0,g=0;found=[];var _=e("#tipue_search_input").val().toLowerCase();if(_=e.trim(_),(_.match('^"')&&_.match('"$')||_.match("^'")&&_.match("'$"))&&(p=!1),p){var f=_.split(" ");_="";for(var v=0;v<f.length;v++){for(var d=!0,w=0;w<tipuesearch_stop_words.length;w++)f[v]==tipuesearch_stop_words[w]&&(d=!1,u=!0);d&&(_=_+" "+f[v])}_=e.trim(_),f=_.split(" ")}else _=_.substring(1,_.length-1);if(_.length>=i.minimumLength){if(p){if(c){for(var m=_,v=0;v<f.length;v++)for(var w=0;w<tipuesearch_replace.words.length;w++)f[v]==tipuesearch_replace.words[w].word&&(_=_.replace(f[v],tipuesearch_replace.words[w].replace_with),o=!0);f=_.split(" ")}for(var x=_,v=0;v<f.length;v++)for(var w=0;w<tipuesearch_stem.words.length;w++)f[v]==tipuesearch_stem.words[w].word&&(x=x+" "+tipuesearch_stem.words[w].stem);f=x.split(" ");for(var v=0;v<t.pages.length;v++){for(var b=0,L=t.pages[v].text,w=0;w<f.length;w++){var E=new RegExp(f[w],"gi");if(-1!=t.pages[v].title.search(E)){var R=t.pages[v].title.match(E).length;b+=20*R}if(-1!=t.pages[v].text.search(E)){var R=t.pages[v].text.match(E).length;b+=20*R}if(i.highlightTerms){if(i.highlightEveryTerm)var C=new RegExp("("+f[w]+")","gi");else var C=new RegExp("("+f[w]+")","i");L=L.replace(C,'<span class="h01">$1</span>')}if(-1!=t.pages[v].tags.search(E)){var R=t.pages[v].tags.match(E).length;b+=10*R}if(-1!=t.pages[v].url.search(E)&&(b+=20),0!=b)for(var T=0;T<tipuesearch_weight.weight.length;T++)t.pages[v].url==tipuesearch_weight.weight[T].url&&(b+=tipuesearch_weight.weight[T].score);f[w].match("^-")&&(E=new RegExp(f[w].substring(1),"i"),(-1!=t.pages[v].title.search(E)||-1!=t.pages[v].text.search(E)||-1!=t.pages[v].tags.search(E))&&(b=0))}0!=b&&(found.push({score:b,title:t.pages[v].title,desc:L,url:t.pages[v].url}),g++)}}else for(var v=0;v<t.pages.length;v++){var b=0,L=t.pages[v].text,E=new RegExp(_,"gi");if(-1!=t.pages[v].title.search(E)){var R=t.pages[v].title.match(E).length;b+=20*R}if(-1!=t.pages[v].text.search(E)){var R=t.pages[v].text.match(E).length;b+=20*R}if(i.highlightTerms){if(i.highlightEveryTerm)var C=new RegExp("("+_+")","gi");else var C=new RegExp("("+_+")","i");L=L.replace(C,'<span class="h01">$1</span>')}if(-1!=t.pages[v].tags.search(E)){var R=t.pages[v].tags.match(E).length;b+=10*R}if(-1!=t.pages[v].url.search(E)&&(b+=20),0!=b)for(var T=0;T<tipuesearch_weight.weight.length;T++)t.pages[v].url==tipuesearch_weight.weight[T].url&&(b+=tipuesearch_weight.weight[T].score);0!=b&&(found.push({score:b,title:t.pages[v].title,desc:L,url:t.pages[v].url}),g++)}if(0!=g){if(i.showTitleCount&&0==r){var y=document.title;document.title="("+g+") "+y,r++}1==o&&(n+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+_+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+m+"</a></div>"),1==g?n+='<div id="tipue_search_results_count">'+tipuesearch_string_4+"</div>":(c_c=g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),n+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5+"</div>"),found.sort(function(e,t){return t.score-e.score});for(var k=0,v=0;v<found.length;v++){if(k>=s&&k<i.show+s){if(n+='<div class="tipue_search_content_title"><a href="'+found[v].url+'"'+a+">"+found[v].title+"</a></div>",i.debug&&(n+='<div class="tipue_search_content_debug">Score: '+found[v].score+"</div>"),i.showURL){var W=found[v].url.toLowerCase();0==W.indexOf("http://")&&(W=W.slice(7)),n+='<div class="tipue_search_content_url"><a href="'+found[v].url+'"'+a+">"+W+"</a></div>"}if(found[v].desc){var $=found[v].desc,O="",S=$.split(" ");if(S.length<i.descriptiveWords)O=$;else for(var w=0;w<i.descriptiveWords;w++)O+=S[w]+" ";O=e.trim(O),"."!=O.charAt(O.length-1)&&(O+=" ..."),n+='<div class="tipue_search_content_text">'+O+"</div>"}}k++}if(g>i.show){var j=Math.ceil(g/i.show),D=s/i.show;if(n+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',s>0&&(n+='<li><a class="tipue_search_foot_box" id="'+(s-i.show)+"_"+c+'">'+tipuesearch_string_6+"</a></li>"),2>=D){var U=j;j>3&&(U=3);for(var w=0;U>w;w++)n+=w==D?'<li class="current">'+(w+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+w*i.show+"_"+c+'">'+(w+1)+"</a></li>"}else{var U=D+2;U>j&&(U=j);for(var w=D-1;U>w;w++)n+=w==D?'<li class="current">'+(w+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+w*i.show+"_"+c+'">'+(w+1)+"</a></li>"}D+1!=j&&(n+='<li><a class="tipue_search_foot_box" id="'+(s+i.show)+"_"+c+'">'+tipuesearch_string_7+"</a></li>"),n+="</ul></div>"}}else n+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else u?n+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(n+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",n+=1==i.minimumLength?'<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":'<div id="tipue_search_warning">'+tipuesearch_string_12+" "+i.minimumLength+" "+tipuesearch_string_13+"</div>");e("#tipue_search_content").hide(),e("#tipue_search_content").html(n),e("#tipue_search_content").slideDown(200),e("#tipue_search_replaced").click(function(){h(0,!1)}),e(".tipue_search_foot_box").click(function(){var t=e(this).attr("id"),i=t.split("_");h(parseInt(i[0]),i[1])})}var t={pages:[]};e.ajaxSetup({async:!1});var r=0;if("live"==i.mode)for(var s=0;s<tipuesearch_pages.length;s++)e.get(tipuesearch_pages[s]).done(function(r){var a=e(i.liveContent,r).text();a=a.replace(/\s+/g," ");var c=e(i.liveDescription,r).text();c=c.replace(/\s+/g," ");var h=r.toLowerCase().indexOf("<title>"),n=r.toLowerCase().indexOf("</title>",h+7);if(-1!=h&&-1!=n)var l=r.slice(h+7,n);else var l=tipuesearch_string_1;t.pages.push({title:l,text:c,tags:a,url:tipuesearch_pages[s]})});"json"==i.mode&&e.getJSON(i.contentLocation).done(function(i){t=e.extend({},i)}),"static"==i.mode&&(t=e.extend({},tipuesearch));var a="";i.newWindow&&(a=' target="_blank"'),c("q")&&(e("#tipue_search_input").val(c("q")),h(0,!0)),e(this).keyup(function(e){"13"==e.keyCode&&h(0,!0)})})}}(jQuery);